{% extends "base.html" %}
{% block title %}{{ account.name }} — Holdings{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol>
    <li><a href="/accounts">Accounts</a></li>
    <li>{{ account.name }}</li>
  </ol>
</nav>

<h2>{{ account.name }} — Holdings</h2>

<div style="overflow-x:auto">
  <table>
    <thead>
      <tr>
        <th>Ticker</th>
        <th class="text-right">Quantity</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="holdings-body">
      {% for holding in holdings %}
        {% include "accounts/_holding_row.html" %}
      {% else %}
      <tr><td colspan="3" style="text-align:center">보유 내역이 없습니다. 아래에서 추가하세요.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<h3>New Holding</h3>
<form hx-post="/accounts/{{ account.id }}/holdings"
      hx-target="#holdings-body"
      hx-swap="afterbegin"
      hx-on::after-request="this.reset()">
  <div style="display:flex;gap:1rem;align-items:flex-end;flex-wrap:wrap">
    <label style="flex:2;min-width:200px">
      Stock
      <select name="stock_id" required>
        <option value="">-- 종목 선택 --</option>
        {% for stock in all_stocks %}
        <option value="{{ stock.id }}">{{ stock.ticker }}</option>
        {% endfor %}
      </select>
    </label>
    <label style="flex:1;min-width:120px">
      Quantity
      <input type="number" name="quantity" value="0" min="0" step="0.000001" required>
    </label>
    <div>
      <button type="submit">Add Holding</button>
    </div>
  </div>
</form>
{% endblock %}
