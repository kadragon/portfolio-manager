{% extends "base.html" %}
{% block title %}{{ account.name }} 보유 내역 — 포트폴리오 매니저{% endblock %}

{% block content %}
<nav class="breadcrumb" aria-label="breadcrumb">
  <ol>
    <li><a href="/accounts">계좌</a></li>
    <li>{{ account.name }}</li>
  </ol>
</nav>

<h2 class="page-header">{{ account.name }} 보유 내역</h2>
<p class="page-subtitle">계좌의 종목별 수량을 관리합니다.</p>

<section class="section-card">
  <div class="table-wrap">
    <table class="table-compact">
      <thead>
        <tr>
          <th>티커</th>
          <th class="text-right">수량</th>
          <th>작업</th>
        </tr>
      </thead>
      <tbody id="holdings-body">
        {% for holding in holdings %}
          {% include "accounts/_holding_row.html" %}
        {% else %}
        <tr class="empty-row"><td colspan="3">보유 내역이 없습니다. 아래에서 새 보유를 추가하세요.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>

<section class="section-card">
  <h3>보유 추가</h3>
  <form hx-post="/accounts/{{ account.id }}/holdings"
        hx-target="#holdings-body"
        hx-swap="afterbegin"
        hx-on::after-request="this.reset()"
        data-request-message="보유 내역을 추가하는 중…">
    <div class="form-grid">
      <label class="form-field form-field-wide">
        종목<span class="required-marker" aria-hidden="true">*</span>
        <select name="stock_id" required>
          <option value="">종목을 선택하세요…</option>
          {% for stock in all_stocks %}
          <option value="{{ stock.id }}">{{ stock.ticker }}</option>
          {% endfor %}
        </select>
      </label>
      <label class="form-field form-field-mid">
        수량<span class="required-marker" aria-hidden="true">*</span>
        <input type="number" name="quantity" value="0" min="0" step="0.000001" required autocomplete="off">
      </label>
      <div>
        <button type="submit" class="btn btn-primary">보유 추가</button>
      </div>
    </div>
  </form>
</section>
{% endblock %}
