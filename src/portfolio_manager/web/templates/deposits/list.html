{% extends "base.html" %}
{% block title %}Deposits — Portfolio Manager{% endblock %}

{% block content %}
<h2>Deposits</h2>
<p>Total Invested: <strong>{{ total | format_krw }}</strong></p>

<div style="overflow-x:auto">
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th class="text-right">Amount</th>
        <th>Note</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="deposits-body">
      {% for deposit in deposits %}
        {% include "deposits/_row.html" %}
      {% else %}
      <tr><td colspan="4" style="text-align:center">입금 내역이 없습니다. 아래에서 추가하세요.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<h3>New Deposit</h3>
<p style="font-size:0.85rem;color:var(--pico-muted-color)">
  같은 날짜에 입금이 이미 있으면 자동으로 수정됩니다.
</p>
<form hx-post="/deposits"
      hx-target="#deposits-body"
      hx-swap="afterbegin"
      hx-on::after-request="this.reset()">
  <div style="display:flex;gap:1rem;align-items:flex-end;flex-wrap:wrap">
    <label style="flex:1;min-width:140px">
      Date
      <input type="date" name="deposit_date" required>
    </label>
    <label style="flex:1;min-width:140px">
      Amount (KRW)
      <input type="number" name="amount" value="" min="0" step="1" required>
    </label>
    <label style="flex:2;min-width:180px">
      Note (optional)
      <input type="text" name="note" placeholder="메모">
    </label>
    <div>
      <button type="submit">Add Deposit</button>
    </div>
  </div>
</form>
{% endblock %}
